@using PanoramicData.Blazor.Extensions

<svg height="@Height"
	 preserveAspectRatio="none"
	 viewBox="@CalculateViewBox()"
	 width="@(TotalPeriods * Options.Bar.Width)"
	 x="@X"
	 y="@Y">

	<line x2="@(TotalPeriods * Options.Bar.Width)" stroke="black" />

	@for (var i = 1; i < TotalPeriods; i++)
	{
		<line x1="@(i * Options.Bar.Width)" x2="@(i * Options.Bar.Width)" y2="5" stroke="silver" />
	}

	@if (DataPoints.Length > 0)
	{
		var dt = DataPoints[0].StartTime;
		for (var i = 0; i < TotalPeriods; i++)
		{
			var textInfo = GetTextInfo(dt);

			<line x1="@(i * Options.Bar.Width)" x2="@(i * Options.Bar.Width)" y2="20" stroke="black" />

			<text>
				<text x="@((i * Options.Bar.Width) + @textInfo.OffsetX)" y="@textInfo.OffsetY">@textInfo.Text</text>
			</text>

			for (var s = 0; s < textInfo.Skip; s++, i++)
			{
				dt = dt.PeriodEnd(Scale);
			}
			dt = dt.PeriodEnd(Scale);
		}
	}

</svg>